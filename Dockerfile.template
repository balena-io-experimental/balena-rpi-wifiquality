FROM resin/%%RESIN_MACHINE_NAME%%-alpine-node

MAINTAINER Gergely Imreh <gergely@resin.io>

ENV INITSYSTEM on
WORKDIR /usr/src/app

RUN apk add --no-cache wireless-tools cairo-dev

COPY package.json package.json
RUN JOBS=MAX npm install --production --unsafe-perm && npm cache clean && rm -rf /tmp/*

COPY . ./

CMD ./prestart.sh && ./start.sh
